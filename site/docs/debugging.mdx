# Debugging & Troubleshooting

Quick solutions to common AKIOS issues. Most problems are configuration-related and easy to fix.

## Quick Diagnosis

Start here when something's wrong:

```bash
# Check overall status
akios status

# View recent logs
akios logs --limit 10

# Run diagnostics
akios doctor

# Enable debug mode
akios --debug status
```

## Installation Issues

### "akios: command not found"

**Pip installation:**
```bash
# Check if installed
pip show akios

# Reinstall if needed
pip uninstall akios
pip install akios>={{version}}

# Check PATH
which akios
```

**Docker wrapper:**
```bash
# Make executable
chmod +x akios

# Use from current directory
./akios --version
```

### "Docker daemon not running"

```bash
# Start Docker Desktop (macOS/Windows)

# Or on Linux
sudo systemctl start docker

# Test Docker
docker run hello-world
```

### "Permission denied" (Docker)

```bash
# Add user to docker group (Linux)
sudo usermod -aG docker $USER

# Logout and login again

# Or use sudo (less secure)
sudo docker run...
```

## Configuration Issues

### "API key not found" or "Invalid API key"

```bash
# Run setup wizard to fix
akios setup --force

# Or manually edit .env
nano .env

# Check what AKIOS sees
akios status --verbose
```

### "Invalid provider/model combination"

**Supported combinations:**
- OpenAI: `gpt-3.5-turbo`, `gpt-4`, `gpt-4o`
- Anthropic: `claude-3.5-haiku`, `claude-3.5-sonnet`
- Grok: `grok-3`
- Mistral: `mistral-large`
- Gemini: `gemini-1.5-pro`

```bash
# Fix in .env
AKIOS_LLM_PROVIDER=grok
AKIOS_LLM_MODEL=grok-3
```

### "Configuration validation failed"

```bash
# Check config syntax
python3 -c "import yaml; yaml.safe_load(open('config.yaml'))"

# Or just reset
akios setup --force
```

### ".env file corrupted"

Common issues the wizard detects:
- `grokopenai` → Should be `grok`
- `tru` → Should be `true`
- Missing API keys

```bash
# Let wizard fix it
akios setup --force
```

## Workflow Execution Issues

### "Template not found"

```bash
# List available templates
akios templates list

# Check file exists
ls templates/

# Use correct path
akios run templates/hello-workflow.yml
```

### "Workflow validation failed"

Each step needs:
- `agent` - Which agent to use
- `action` - What action to perform
- `parameters` - Action-specific settings

**Allowed agents:** `llm`, `http`, `filesystem`, `tool_executor`

### "Path not allowed" (Filesystem Agent)

Only these directories are accessible:
- `./workflows/`
- `./templates/`
- `./data/input/`
- `./data/output/`

```bash
# Move file to allowed location
mv myfile.txt data/input/
```

### "Network access blocked" (HTTP Agent)

```bash
# Enable network in config.yaml
network_access_allowed: true

# Or use environment variable
export AKIOS_NETWORK_ACCESS_ALLOWED=1
```

### "Budget exceeded"

```bash
# Check current usage
akios status --budget

# Increase limit
export AKIOS_BUDGET_LIMIT_PER_RUN=5.0

# Or edit config.yaml
# budget_limit_per_run: 5.0
```

## Docker-Specific Issues

### "Docker image outdated"

```bash
# Pull latest image
docker pull akiosai/akios:v{{version}}

# Or force pull with wrapper
AKIOS_FORCE_PULL=1 ./akios status
```

### "Container exits immediately"

```bash
# Check logs
akios logs --limit 10

# Run with debug
akios --debug run workflow.yml
```

### "File operations slow" (macOS/Windows)

- Update Docker Desktop to latest version
- Check Docker resource settings
- Consider native Linux for maximum performance

## Security Issues

### "Security validation failed"

**On Linux:**
- Ensure kernel >= 5.4
- Check seccomp support
- Install `libseccomp-dev`

**On macOS/Windows:**
- Use Docker (provides strong security)
- Install Docker Desktop

```bash
# Check your security status
akios status --security
```

### "PII detected in logs"

This shouldn't happen! Check:

```bash
# Verify PII redaction is on
akios status --security
# Should show: PII Protection: Active
```

If PII is leaking, report to **hello@akios.ai**

## Performance Issues

### "Workflow running slow"

```bash
# Check resource usage
akios status --verbose

# Increase limits in config.yaml
cpu_limit: 0.9
memory_limit_mb: 512
```

### "High memory usage"

```bash
# Reduce memory limit
memory_limit_mb: 128

# Process smaller files
# Clean old runs
akios clean --old-runs 7
```

## Emergency Recovery

If everything is broken:

```bash
# 1. Stop any running workflows
pkill -f akios

# 2. Backup your data
cp -r data/ data.backup

# 3. Reset configuration
akios setup --force

# 4. Clean old runs
akios clean --old-runs 1

# 5. Test with simple workflow
akios run templates/hello-workflow.yml
```

## Getting More Help

### Enable Debug Mode

```bash
# Debug flag
akios --debug run workflow.yml

# Or environment variable
export AKIOS_DEBUG=1
akios run workflow.yml
```

### Check Logs

```bash
# Recent logs
akios logs --limit 20

# Error logs only
akios logs --level ERROR

# Audit trail
tail -20 audit/audit_events.jsonl
```

### Run Diagnostics

```bash
# Full diagnostics
akios doctor

# JSON output for bug reports
akios doctor --json > diagnostics.json
```

### Still Stuck?

- Check [GitHub Issues](https://github.com/akios-ai/akios/issues)
- Ask in [GitHub Discussions](https://github.com/akios-ai/akios/discussions)
- Email: **hello@akios.ai**

**Include in bug reports:**
- `akios --version`
- `akios doctor --json`
- Steps to reproduce
- Expected vs actual behavior

## Related Docs

- **[Configuration](config-reference.html)** - All config options
- **[Security](security.html)** - Security features
- **[CLI Reference](cli-reference.html)** - All commands
