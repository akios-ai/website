# CLI Reference

Complete command reference for AKIOS. All commands work with pip install, Docker wrapper, or direct Docker.

## Quick Start Commands

The commands you'll use most:

```bash
akios init my-project          # Create new project
akios setup                    # Configure API keys
akios run templates/hello.yml  # Run a workflow
akios status                   # Check system status
akios logs --limit 10          # View recent logs
akios clean --old-runs         # Clean up old runs
```

## Installation Methods

Choose your preferred installation:

### Pip (Linux - Maximum Security)
```bash
pip install akios>={{version}}
akios --version
```

### Docker Wrapper (Cross-Platform)
```bash
curl -O https://raw.githubusercontent.com/akios-ai/akios/main/src/akios/cli/data/wrapper.sh
mv wrapper.sh akios
chmod +x akios
./akios --version
```

### Direct Docker (Fallback)
```bash
docker run --rm -v "$(pwd):/app" -w /app akiosai/akios:v{{version}} --version
```

## Global Options

Available on all commands:

```bash
akios --help               # Show command help
akios --version            # Show version info
akios --debug <command>    # Enable debug output
```

## Project Commands

### `akios init [path]`
Create a new AKIOS project with templates and configuration.

```bash
# Create project in current directory
akios init

# Create project in subdirectory
akios init my-project

# Create quietly (no banners)
akios init --quiet

# Initialize and run setup wizard immediately
akios init --wizard
```

**Options:**
- `--force` - Overwrite existing files
- `--quiet` - Suppress welcome message
- `--json` - Output in JSON format
- `--wizard` - Run the setup wizard after project initialization

**Creates:**
- `config.yaml` - Runtime configuration
- `templates/` - Example workflows
- `workflows/` - Your custom workflows
- `data/input/` and `data/output/` - File storage
- `audit/` - Security logs
- `.env` and `.env.example` - API key configuration

### `akios setup [--force]`
Interactive wizard to configure API keys and settings.

```bash
# Run setup wizard (first-time setup)
akios setup

# Force re-run (reconfigure everything)
akios setup --force

# Non-interactive mode (CI/CD)
akios setup --non-interactive

# Use defaults (quick setup)
akios setup --defaults

# Enable mock mode (no API keys needed)
akios setup --mock-mode
```

**Configures:**
- AI provider (OpenAI, Anthropic, Grok, Mistral, Gemini)
- API key with validation
- Budget limits ($1.00 default)
- Token limits (1000 per call default)
- Network access settings

### `akios status [options]`
Show system status and security information.

```bash
# Basic status
akios status

# Detailed security dashboard
akios status --security

# Budget tracking details
akios status --budget

# Machine-readable JSON
akios status --json

# Detailed technical info
akios status --verbose
```

**Shows:**
- Security level (Full/Strong)
- PII protection status
- Budget usage and remaining
- Audit logging status
- Recent workflow runs

### `akios clean [options]`
Remove old workflow runs to free disk space.

```bash
# Remove runs older than 7 days (default)
akios clean --old-runs

# Remove runs older than 30 days
akios clean --old-runs 30

# Preview what would be cleaned
akios clean --old-runs 7 --dry-run

# JSON output for scripts
akios clean --old-runs 7 --json
```

**Safety:** Only removes `data/output/run_*` directories. Audit logs are never touched.

## Workflow Commands

### `akios run <workflow.yml> [options]`
Execute a workflow with full security.

```bash
# Run a template
akios run templates/hello-workflow.yml

# Run your custom workflow
akios run workflows/my-workflow.yml

# Enable real API mode (interactive setup)
akios run workflow.yml --real-api

# Verbose output
akios run workflow.yml --verbose

# Dry run (validate only)
akios run workflow.yml --dry-run

# Skip confirmations
akios run workflow.yml --force
```

**Options:**
- `--real-api` - Enable live APIs with setup wizard
- `--verbose, -v` - Detailed execution logs
- `--quiet, -q` - Suppress banners
- `--dry-run, -d` - Validate without executing
- `--force, -f` - Skip confirmation prompts
- `--debug` - Enable debug logging

### `akios templates list`
Show all available workflow templates.

```bash
akios templates list
```

**Output:**
```
Available Templates
===================
hello-workflow.yml        Simple AI greeting example
document_ingestion.yml    Document analysis with PII redaction
batch_processing.yml      Multi-file processing with cost tracking
file_analysis.yml         Security-focused file scanning
```

### `akios files [input|output]`
Show available input files and output runs.

```bash
# Show all files
akios files

# Show only input files
akios files input

# Show only output runs
akios files output
```

Helps you see what data is available for your workflows.

## Audit & Logging Commands

### `akios logs [options]`
View workflow execution logs.

```bash
# Show recent logs (default 20 entries)
akios logs

# Show last 50 entries
akios logs --limit 50

# Show logs for specific workflow
akios logs --task workflow-123

# Filter by log level
akios logs --level ERROR
```

**Options:**
- `--limit, -l` - Number of entries to show
- `--task, -t` - Filter by workflow ID
- `--level` - Filter by level (INFO, ERROR, etc.)

### `akios audit export [options]`
Export cryptographic audit trail.

```bash
# Export latest audit (auto-generated filename)
akios audit export

# Export with custom filename
akios audit export --output audit-report.json

# Export specific workflow
akios audit export --task workflow-123 --output audit.json
```

**Options:**
- `--output, -o` - Output file path
- `--task, -t` - Specific workflow ID
- `--format, -f` - Export format (json)

## Advanced Commands

### `akios doctor [--json]`
Run system diagnostics.

```bash
# Show diagnostics
akios doctor

# JSON output for scripts
akios doctor --json
```

Checks security status, configuration, and system health.

### `akios compliance report <workflow.yml> [options]`
Generate compliance reports.

```bash
# Basic compliance report
akios compliance report hello-workflow.yml

# Detailed technical report
akios compliance report workflow.yml --type detailed

# Executive summary
akios compliance report workflow.yml --type executive --format txt

# Export to file
akios compliance report workflow.yml --output compliance.json
```

**Report types:**
- `basic` - Security validation summary
- `detailed` - Technical details + audit events
- `executive` - High-level management summary

### `akios output` — Manage Workflow Outputs

Manage and organize workflow outputs with advanced file operations.

```bash
# Get the latest workflow output as deployable JSON
akios output latest

# List all workflow outputs
akios output list

# List outputs for specific workflow
akios output list hello-workflow.yml

# Clean old outputs for a workflow
akios output clean hello-workflow.yml --max-age 7

# Archive outputs for a workflow
akios output archive hello-workflow.yml --name archive.tar.gz
```

**Subcommands:**

#### `latest`
Retrieve the most recent workflow execution result as structured JSON — designed for CI/CD pipeline integration. The output includes metadata (version, workflow name, ID, timestamp), execution details (status, steps, timing), security state (PII, audit, sandbox), cost breakdown (total, budget, remaining), and per-step results.

#### `list`
List workflow outputs. Optionally filter by workflow name.

#### `clean`
Clean old workflow outputs. Options: `--max-age` (days, default 30), `--max-count` (default 50), `--dry-run`, `--json`.

#### `archive`
Archive workflow outputs. Options: `--name` (filename, auto-generated if omitted), `--json`.

### `akios cage` / `akios security` — Security Cage Management

Manage the AKIOS security cage — control PII redaction, network access, sandboxing, and audit logging. `cage` and `security` are interchangeable aliases.

```bash
# Activate full security (PII redaction, HTTPS lock, sandbox, audit)
akios cage up

# Relax security for development (destroys session data by default)
akios cage down

# Dev mode — relax protections, keep data for debugging
akios cage down --keep-data

# Show current cage posture and protection status
akios cage status

# Same commands via 'security' alias
akios security up
akios security down
akios security status
```

**`cage up`** activates: PII Redaction (enabled), HTTPS Network (locked — LLM APIs and `allowed_domains` pass through), Sandbox (enforced), Audit Logging (enabled).

**`cage down`** (default) **destroys all session data** — `audit/`, `data/output/`, `data/input/` are permanently deleted. This is the cage's core promise: zero data residue when the cage goes down.

**`cage down --keep-data`** relaxes protections without wiping data (development convenience only).

**`cage status`** displays current posture (ACTIVE / RELAXED / CUSTOM) and protection table.

### `akios protect` — PII Protection Analysis

Analyze workflows and files for PII exposure before execution.

```bash
# Preview PII detection on a workflow
akios protect preview templates/hello-workflow.yml

# Scan a file for PII and show redaction results
akios protect scan data/input/document.txt

# JSON output for scripting
akios protect preview --json
akios protect scan data/input/document.txt --json
```

**`preview`** scans workflow inputs for PII and shows safe prompt construction.

**`scan`** scans a file for PII and displays detected sensitive data categories.

### `akios audit verify` — Verify Audit Integrity

Verify the Merkle-chain integrity of the cryptographic audit trail.

```bash
akios audit verify
akios audit verify --json
```

Returns chain integrity status, hash verification results, and tamper detection.

### `akios audit log` — View Audit Log

View recent entries from the cryptographic audit log.

```bash
akios audit log
akios audit log --limit 20
```

Options: `--limit, -n` (default 10), `--json`.

### `akios docs` — View Documentation

View AKIOS documentation with Markdown rendering directly in the terminal.

```bash
akios docs
akios docs security
akios docs workflows
```

### `akios timeline` — Workflow Timeline

View workflow execution timeline with performance analysis and step-by-step timing.

```bash
akios timeline
akios timeline --verbose
akios timeline --json
```

### `akios testing` — Testing Context

View environment notes and testing context for the current project.

```bash
akios testing
```

Displays mock mode status, API key availability, and testing recommendations.

## LLM Provider/Model Validation

AKIOS validates LLM provider and model compatibility at startup to prevent API failures.

| Provider | Models |
|----------|--------|
| **OpenAI** | `gpt-3.5-turbo`, `gpt-4`, `gpt-4-turbo`, `gpt-4o`, `gpt-4o-mini` |
| **Anthropic** | `claude-3.5-haiku`, `claude-3.5-sonnet` |
| **Grok** | `grok-3` |
| **Mistral** | `mistral-small`, `mistral-medium`, `mistral-large` |
| **Gemini** | `gemini-1.0-pro`, `gemini-1.5-pro`, `gemini-1.5-flash` |

Validation is case-insensitive. Invalid combinations fail early with clear error messages:

```bash
# Invalid — wrong provider for model
AKIOS_LLM_PROVIDER=openai AKIOS_LLM_MODEL=grok-3 akios status
# Error: "Model 'grok-3' is not valid for provider 'openai'"
```

Use `AKIOS_JSON_MODE=1` for structured error output in CI/CD.

## Environment Variables

Control AKIOS behavior with environment variables:

```bash
# Show JSON output
AKIOS_JSON_MODE=1 akios status

# Enable debug logging
AKIOS_DEBUG=1 akios run workflow.yml

# Set API provider
AKIOS_LLM_PROVIDER=grok akios status

# Enable mock mode
AKIOS_MOCK_LLM=1 akios run workflow.yml
```

## Common Workflows

### First-Time Setup
```bash
# 1. Install
pip install akios>={{version}}

# 2. Create project
akios init my-project
cd my-project

# 3. Configure
akios setup

# 4. Run example
akios run templates/hello-workflow.yml

# 5. Check status
akios status
```

### Daily Usage
```bash
# Run your workflow
akios run workflows/my-workflow.yml

# Check results
akios files output

# View logs
akios logs --limit 10

# Clean up periodically
akios clean --old-runs 7
```

### Troubleshooting
```bash
# Check security status
akios status --security

# Enable debug mode
akios --debug run workflow.yml

# Run diagnostics
akios doctor

# View detailed logs
akios logs --limit 50 --level ERROR
```

## Getting Help

```bash
# General help
akios --help

# Command-specific help
akios run --help
akios status --help
akios clean --help

# Show version
akios --version
```

## Platform Differences

**Native Linux (pip):**
- Full kernel-hard security
- Best performance
- Maximum isolation
- Commands: `akios <command>`

**Docker (all platforms):**
- Strong policy-based security
- Cross-platform compatibility
- Container isolation
- Commands: `./akios <command>` (from project directory)

Both methods provide the same commands and strong security.

## Learn More

- **[Quickstart](quickstart.html)** - Get started guide
- **[Concepts](concepts.html)** - How AKIOS works
- **[Configuration](config-reference.html)** - Customize settings
- **[Debugging](debugging.html)** - Troubleshooting guide
